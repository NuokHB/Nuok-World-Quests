<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<HBProfile>
  <Name>[Nuok] Highmountain Loader</Name>
  <MinDurability>0.2</MinDurability>
  <MinFreeBagSlots>1</MinFreeBagSlots>
  <MinLevel>1</MinLevel>
  <MaxLevel>1000</MaxLevel>
  <MailGrey>false</MailGrey>
  <MailWhite>true</MailWhite>
  <MailGreen>true</MailGreen>
  <MailBlue>true</MailBlue>
  <MailPurple>true</MailPurple>
  <SellGrey>true</SellGrey>
  <SellWhite>false</SellWhite>
  <SellGreen>false</SellGreen>
  <SellBlue>false</SellBlue>
  <SellPurple>false</SellPurple>
  <TargetElites>true</TargetElites>
  <QuestOrder>
    <CustomBehavior File="RunCode" Type="Definition"><![CDATA[public bool OnQuest(int questId){ return Lua.GetReturnVal<bool>($@"SetMapByID(1024);
local taskInfo = C_TaskQuest.GetQuestsForPlayerByMapID(1024); 
if (taskInfo) then 
for i, info  in ipairs(taskInfo) do 
C_TaskQuest.RequestPreloadRewardData(info.questId);
if info.questId == {questId} then 
return true; 
end 
end 
end 
return false", 0); }]]></CustomBehavior>
    <CustomBehavior File="RunCode" Type="Definition"><![CDATA[    public class Settings : Styx.Helpers.Settings
    {
        public static readonly string _settingsPath = Path.Combine(CharacterSettingsDirectory, "Profiles",
            "NuokWorldQuestSettings.xml");

        private static Settings _instance;

        public static Settings Instance => _instance ?? (_instance = new Settings());

        public Settings() : base(_settingsPath)
        {
        }

        [Setting]
        public bool DoWanted { get; set; }

        [Setting]
        public bool DoDangerQuests { get; set; }

        [Setting]
        public bool ArtifactPower { get; set; }

        [Setting]
        public bool Equipment { get; set; }

        [Setting]
        public bool Blood { get; set; }

        [Setting]
        public bool OrderHall { get; set; }

        [Setting]
        public bool Gold { get; set; }
    }]]></CustomBehavior>
    <CustomBehavior File="RunCode" Type="Definition"><![CDATA[public int QuestRewardType(int questId)
        {
            var questLua = $@"local numQuestCurrencies = GetNumQuestLogRewardCurrencies({questId});
local money = GetQuestLogRewardMoney({questId});
local artifactXP  = GetQuestLogRewardArtifactXP({questId});
local numQuestRewards = GetNumQuestLogRewards({questId})
if numQuestCurrencies > 0 then
    return 5;
end

if money > 0 then 
    return 1;
end

if artifactXP > 0 then 
    return 2;
end

if numQuestRewards > 0 then 
    local name, texture, numItems, quality, isUsable, itemID = GetQuestLogRewardInfo(1, {questId});
        if itemID == 124124 then 
	    return 3;
	    end
    return 4;
end
    

return 0;";
            return Lua.GetReturnVal<int>(questLua, 0);
        }

        public bool PassesSettings(int questId)
        {
            //return error = 0, gold = 1, artifactpower = 2, items = 3, blood = 4, currency = 5
            var rewardType = QuestRewardType(questId);
            switch (rewardType)
            {
                case 1:
                    return Settings.Instance.Gold;
                case 2:
                    return Settings.Instance.ArtifactPower;
                case 3:
                    return Settings.Instance.Equipment;
                case 4:
                    return Settings.Instance.Blood;
                case 5:
                    return Settings.Instance.OrderHall;
            }
            return false;
        }]]></CustomBehavior>
    <If Condition="OnQuest(40978) &amp;&amp; PassesSettings(40978)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 40978 - Bears Behaving Badly&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="40978 - Bears Behaving Badly" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41144) &amp;&amp; PassesSettings(41144)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41144 - Return to the River&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41144 - Return to the River" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41145) &amp;&amp; PassesSettings(41145)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41145 - Water of Life&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41145 - Water of Life" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41416) &amp;&amp; PassesSettings(41416)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41416 - Retake the Skyhorn&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41416 - Retake the Skyhorn" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41428) &amp;&amp; PassesSettings(41428)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41428 - Unstable Portal&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41428 - Unstable Portal" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41685) &amp;&amp; Settings.Instance.DoDangerQuests &amp;&amp; PassesSettings(41685)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41685 - DANGER Ala'washte&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41685 - DANGER Ala'washte" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41701) &amp;&amp; PassesSettings(41701)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41701 - Gettin' Tuffer&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41701 - Gettin' Tuffer" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41703) &amp;&amp; Settings.Instance.DoDangerQuests &amp;&amp; PassesSettings(41703)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41703 - DANGER Ormagrogg&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41703 - DANGER Ormagrogg" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41705) &amp;&amp; PassesSettings(41705)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41705 - Assault on Thunder Totem&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41705 - Assault on Thunder Totem" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41789) &amp;&amp; PassesSettings(41789)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41789 - Return to the Crag&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41789 - Return to the Crag" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41794) &amp;&amp; PassesSettings(41794)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41794 - Drakestalker&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41794 - Drakestalker" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(41844) &amp;&amp; Settings.Instance.DoWanted &amp;&amp; PassesSettings(41844)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 41844 - WANTED Sekhan&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="41844 - WANTED Sekhan" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(44291) &amp;&amp; Settings.Instance.DoWanted &amp;&amp; PassesSettings(44291)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 44291 - WANTED Crawshuk the Hungry&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="44291 - WANTED Crawshuk the Hungry" RememberProfile="false" />
    </If>
    <If Condition="OnQuest(44292) &amp;&amp; Settings.Instance.DoWanted &amp;&amp; PassesSettings(44292)">
      <CustomBehavior File="RunCode" Code="Logging.Write(System.Windows.Media.Colors.LightGray, &quot;[NuokWorldQuest]&quot; + &quot;Loading 44292 - WANTED Majestic Elderhorn&quot;);" />
      <CustomBehavior File="LoadProfile" ProfileName="44292 - WANTED Majestic Elderhorn" RememberProfile="false" />
    </If>
  </QuestOrder>
</HBProfile>